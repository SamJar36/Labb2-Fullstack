@page "/search-product-name"
@rendermode InteractiveServer
@using Shared
@inject HttpClient Http

<h3>Search Product by ID</h3>
<input @bind="inputValue" placeholder="Enter name" />
<button @onclick="() => SearchByName(inputValue)">Go</button><br />

<ul>
	@if (productsWithName != null)
	{
		@foreach (var product in productsWithName)
		{
			<li>
				<hr />
				<strong>Id: </strong> @product.Id <br />
				<strong>Product name:</strong> @product.ProductName <br />
				<strong>Product description:</strong> @product.ProductDescription <br />
				<strong>Price:</strong> @product.Price <br />
				<strong>Product category:</strong> @product.ProductCategory<br />
				<strong>Status:</strong> @product.Status <br />
			</li>
		}
	}
</ul>

@code {
	private string inputValue;

	private List<Product> productsWithName = new List<Product>();

	private List<Product> products;

	protected override async Task OnInitializedAsync()
	{
		products = await Http.GetFromJsonAsync<List<Product>>("api/products");
	}

	private async Task SearchByName(string name)
	{
		productsWithName.Clear();
		var response = await Http.GetAsync($"api/products/search-by-name/{name}");

		if (response.IsSuccessStatusCode)
		{
			productsWithName = products.Where(c => c.ProductName == name).ToList();
		}
	}
}
